# New Gate - API Specification

# Table of Contents
- [1. Documentation History](#1-documentation-history)
- [2. Document Reference](#2-document-reference)
- [3. Message Definition And Transaction Flow](#3-message-definition-and-transaction-flow)
- [4. Transaction Flow](#4-transaction-flow)
- [5. Message Formats](#5-message-formats)
    - [5.1 Postman Sample](#51-postman-sample)
    - [5.2 Inquiry](#52-inquiry)
    - [5.3 Payment](#53-payment)
    - [5.4 Advice](#54-advice)
    - [5.5 Check Status](#55-check-status)
    - [5.6 Reversal](#56-reversal)
    - [5.7 Update Balance](#57-update-balance)
- [6. Channel Id](#6-channel-id)
- [7. Response Code](#7-response-code)
- [8. Signature](#8-signature)
    - [8.1. HMAC-SHA256](#81-hmac-sha256)
    - [8.2. SHA256 with RSA](#82-sha256-with-rsa)
- [9. Receipt Format](#9-receipt-format)

# 1. Documentation History

| Version | **Author** | Date | **Description** |
| --- | --- | --- | --- |
| 1.0 | RAP & ADK | 06/10/2020 | • Initial Release |
| 1.1 | RAP | 22/10/2020 | • Fixing typo, remove timestamp on sample payload  <br>• Fixing typo, billAmount type changed to number on sample payload following the specification  <br>• Fixing typo totalAmount on sample payload payment response  <br>• Add totalAmount on sample payload request checkStatus and Reversal  <br>• Update signature example |
| 1.2 | ADK | 12/10/2021 | • Fixing typo ‘additionalBillKey’ to ‘billKey’  <br>• Add Response Code List |
| 1.3 | ADK | 29/10/2021 | • Add RC 68 |
| 1.4 | ADK | 26/11/2021 | • Update Data Type RRN to ‘numeric’ |
| 1.5 | ADK | 20/11/2022 | • Update data type all amount description. Remove information about decimal. |
| 1.6 | ADK | 10/08/2022 | • Add tag transId.channelId |
| 1.7 | ADK | 12/07/2023 | • Add tag transId.subAcqId |
| 1.8 | ADK | 18/10/2023 | • Update list Response Code refers to MPAY System |
| 1.9 | Putra/ADK | 12/07/2024 | • Add RC 51 |
| 1.10 | PPP | 29/11/2024 | • Added a different URL that will be used for Topup billers  <br>• Added the option for a signature on the response that will be generated by AJ |
| 1.11 | PPP | 13/12/2024 | • Added a new Signature option for SHA 256 with RSA  <br>• Added a Postman Collection that references this document, specified in section 5.1 Postman Sample |
| 1.12 | ADK | 13/02/2025 | • Update billInfo in Payment Response, there can be additional data needed to be print in receipt  <br>• Add Timeout Flow for PLN Prepaid only  <br>• Add API advice for PLN Prepaid only |
| 1.13 | PPP | 01/10/2025 | • Added more details to section 8. Signature to improve clarity |
| 1.14 | PPP | 01/10/2025 | • Added Update Balance API specifically for Card-Based Topup billers only |
| 1.15.0 | ADK | 15/10/2025 | • Add more information PLN Prepaid Advice flow  <br>• Add RC 41 |

# 2. Document Reference

| **Document Name** | **Version** |
| --- | --- |
| New Gate - API Specification Document version 1.15.0 | 1.15.0 |

# 3\. Message Definition And Transaction Flow

## 3.1 Overview

This document is API interface to do payment or topup. This API specification will be used for all implementation of payment feature in Artajasa.

# 4\. Transaction Flow

On general, transaction between Collecting Agent, Artajasa and Biller is illustrated below.

<img src="./images/trx_flow.jpg" alt="Transaction Flow">

## 4.1 Timeout Flow

We can categorize timeout flow to timeout of payment and timeout of non-payment (example, inquiry).  
For timeout of non-payment, the request can be reinitiated by sending new request in another session.

<img src="./images/timeout-flow-1.png" alt="Timeout Flow">

For timeout of payment, client or sender can check the request using API status. As alternative, client can wait for report transaction on next day, to know whether transaction request is received by destination or not. Same biller support to reverse transaction, it can also be used if payment timeout occur.

<img src="./images/timeout-flow-2.png" alt="Timeout Flow">

For PLN Prepaid timeout of payment, client or sender shall send API advice.

<img src="./images/timeout-flow-3.png" alt="Timeout Flow">

If client or sender get negative response or no response of advice, retry advice shall be sent automatically. Retry advice shall be sent three times. If still get negative response or no response of advice, client or sender shall performe manual advice. And if still get negative response or no response of manual advice, the transaction is suspect and receipt of suspect shall be printed.  
Retry advice shall be sent within 30-35 seconds.

# 5\. Message Formats

This section of the System Requirement Specifications Manual describes the message formats for New Gate system.

The message format charts provided in this section of the manual use the following notations to identify individual data element usage requirements.

The field name on the API is case sensitive.

| **Notation** | **Interpretation** |
| --- | --- |
| M | "Mandatory": The data element is mandatory, and must be provided in the message by the message originator |
| C | "Conditional": The data element is conditionally required to be provided by the sender when specific conditions are applicable. |
| O | “optional”: The data elements is optional to be sent |

## 5.1. Postman Sample

For the following API:

- Inquiry
    
- Payment
    
- Check Status
    

There is a **Postman collection** that can be downloaded to look at the sample Request and Response as well as simple scripts simulating how some fields involved in this specification should behave in live environment. The name of the collection is:

- API-01-New Gate Sample Messages version .postman_collection


## 5.2. Inquiry

This API is used to do inquiry transaction.

- HTTP Method: **POST**
    
- Path for **Payment Billers**: /Artajasa/bersamaPayment/inquiry
    
- Path for **Topup Billers**: /Artajasa/bersamaTopup/inquiry
    
- HTTP Headers
    

| **Name** | **Format** | **Required** | **Description** |
| --- | --- | --- | --- |
| signature | String | M | Signature Request |
| timestamp | String, date formatted | M | time of transaction on with time zone information, (ISO 8601) format |
| acquirerId | String | M | acquirer id identifier given by AJ |

- Query String Parameters: None
    
- Format: application/json
    
- Authentication: None
    
- Request Definitions
    

| **Field** | **Data Type** | **Mandatory** | **Description** |
| --- | --- | --- | --- |
| billerId | String | M | Unique biller ID |
| transId | Object | M | Object used to identify transaction |
| transData | Object | M | List of data related to biller to do transaction |

**transId**

| **Field** | **Data Type** | **Mandatory** | **Description** |
| --- | --- | --- | --- |
| STAN | String, 6 digit numeric | M | System Trace Audit Number, Value increase by 1 from previous transaction |
| RRN | String, 12 digit numeric | M | Retrieval reference number — unique ID incremented by end-user request |
| termId | String, max 15 digit | M | Unique terminal ID per end-user / mobile number |
| channelId | String, max 4 digit | O | It is used to know the type of channel where the transaction is performed. See list of channel Id for detail channel type information |
| subAcqId | String, max 8 digit numeric | C | Sub Acquirer ID. It must exist if the Collecting Agent (acquirer) is aggregator that has ‘Sub-Acquirer’ as payment channel. |

**transData**

| **Field** | **Data Type** | **Mandatory** | **Description** |
| --- | --- | --- | --- |
| idCustomer | String | M | customer id from biller |
| adminFee | Numeric | O | placeholder for admin on inquiry response. Any valid value from request will be ignored |
| billAmount | Numeric | O | placeholder for bill amount on inquiry response. Any valid value from request will be ignored |
| billKey1 | String | C | additional bill data identifier |
| billKey2 | String | C | additional bill data identifier |

- HTTP Headers Response:
    

| **Name** | **Format** | **Required** | **Description** |
| --- | --- | --- | --- |
| signature | String | M | signature response, optionally provided if the CA wants it, otherwise it defaults to the same signature in the request. |
| timestamp | String, date formatted | M | time of AJ response time with time zone information, (ISO 8601) format |

- Response Definition:
    

| **Name** | **Format** | **Required** | **Description** |
| --- | --- | --- | --- |
| billerId | String | M | Echo from request |
| paymentType | String | M | Indicate supported payment type for given biller. Possible value are:  <br>\- “Open” for open payment  <br>\- “Closed” for close payment |
| isFundSuspend | Boolean | M | Indicate CA shall suspend customer’s fund or not. Possible values are:  <br>\- **true**: Customer’s fund shall be suspended  <br>\- **false**: Customer’s fund shall not be suspended |
| transId | Object | M | Object used to identify transaction |
| transData | Object | M | List of data related to biller to do transaction |
| billInfo | Array of Object | C | List of bill information from biller. Will be given if transaction is successful |
| descUI | String | M | Text data need to be displayed after inquiry.  <br>Data content of this field follow the standard JSON String type. |

**transId**

| **Name** | **Format** | **Required** | **Description** |
| --- | --- | --- | --- |
| STAN | String, 6 digit numeric | M | Echo from request |
| RRN | String, 12 digit numeric | M | Echo from request |
| termId | String, max 15 digit | M | Echo from request |
| channelId | String, max 4 digit | O | Echo from request |
| subAcqId | String, max 8 digit numeric | C | Echo from request |
| authKey | String | M | Unique key to internally identify payment process. Should be sent later during payment request |
| respCode | String | M | Response code from biller/API. See list of response code for detail error information |

**transData**

| **Name** | **Format** | **Required** | **Description** |
| --- | --- | --- | --- |
| idCustomer | String | M | Echo from request |
| adminFee | Numeric | O | admin fee from biller, if any. |
| billAmount | Numeric | O | bill amount from biller, if any. In case of open payment, this field will be set to zero. |
| billKey1 | String | O | Echo from request |
| billKey2 | String | O | Echo from request |

**billInfo**

| **Name** | **Format** | **Required** | **Description** |
| --- | --- | --- | --- |
| field | String | M | field name of bill information |
| ID | Number | M | unique field ID, please refer to appendix document |
| isArray | Boolean | M | identifier whether the value is a list of value(array) or single value. If it’s an array, character coma (,) should be used to split it. |
| value | String | C | value of bill information. Will be filled if isArray is false |
| arrValue | Array String | C | List string value of bill information. Will be filled if isArray is true |


### Example Request
```json
  {
    "billerId": "45034",
    "transId": {
        "RRN": "129999910133",
        "STAN": "000133",
        "termId": "12999991",
        "channelId": "6010",
        "subAcqId": "000001"
    },
    "transData": {
        "idCustomer": "0857222222210",
        "adminFee": 0,
        "billAmount" : 0,
        "billKey1" : "",
        "billKey2" : ""
    }
  }
```

### Example Response
```json
{
    "billerId": "45034",
    "paymentType": "Open",
    "isFundSuspend": true,
    "transId": {
        "RRN": "129999910133",
        "STAN": "000133",
        "termId": "12999991",
        "channelId": "6010",
        "subAcqId": "000001",
        "authKey" : "6A1CB5460CDFF065E22D9043FA0035B7",
        "respCode": "00"
    },
    "transData": {
        "idCustomer": "0857222222210",
        "adminFee": 1500.0,
        "billAmount" : 100000.0,
        "billKey1" : "",
        "billKey2" : ""
    },
    "billInfo":[
        {
            "field": "Periode",
            "ID" : 1,
            "isArray" : false,
            "value": "value1"
        },
        {
            "field": "Biaya Denda",
            "ID" : 2,
            "isArray" : true,
            "arrValue": ["token1", "token2", "token3"]
        }
    ],
    "descUI" :"blablabla"
}
```

## 5.3. Payment
This API is used to do payment transaction.

- HTTP Method: **POST**
    
- Path for **Payment Billers**: /Artajasa/bersamaPayment/payment
    
- Path for **Topup Billers**: /Artajasa/bersamaTopup/payment
    
- HTTP Headers:
    

| **Name** | **Format** | **Required** | **Description** |
| --- | --- | --- | --- |
| signature | String | M | Signature Request |
| timestamp | String, date formatted | M | time of transaction on with time zone information, (ISO 8601) format |
| acquirerId | String | M | acquirer id identifier given by AJ |

- Query String Parameters: None
    
- Format: application/json
    
- Authentication: None
    
- Request Definitions:
    

| **Field** | **Data Type** | **Mandatory** | **Description** |
| --- | --- | --- | --- |
| billerId | String | M | Unique biller ID |
| transId | Object | M | Object used to identify transaction |
| transData | Object | M | List of data related to biller to do transaction. should be the same with inquiry response |
| billInfo | Array of Object | M | List of biller information. Results from the inquiry response should be sent back here. |

**transId**

| **Field** | **Data Type** | **Mandatory** | **Description** |
| --- | --- | --- | --- |
| STAN | String, 6 digit numeric | M | System Trace Audit Number, Value increase by 1 from previous transaction |
| RRN | String, 12 digit numeric | M | Retrieval reference number — unique ID incremented by end-user request |
| termId | String, max 15 digit | M | Unique terminal ID per end-user / mobile number |
| channelId | String, max 4 digit | O | It is used to know the type of channel where the transaction is performed. See list of channel Id for detail channel type information |
| subAcqId | String, max 8 digit numeric | C | Sub Acquirer ID. It must exist if the Collecting Agent (acquirer) is aggregator that has ‘Sub-Acquirer’ as payment channel. |
| authkey | String | M | Unique key retrieve from inquiry response. |
| totalAmount | Numeric | M | Total Payment amount, include admin fee (billAmount + adminFee) |

**transData**

| **Field** | **Data Type** | **Mandatory** | **Description** |
| --- | --- | --- | --- |
| idCustomer | String | M | customer id from biller |
| adminFee | Numeric | M | admin fee retrieve from inquiry response. |
| billAmount | Numeric | M | bill amount retrieve from inquiry response. In case of open payment, sender should fill the payment amount from customer here, exclude admin fee. Basically this is the amount customer need to pay, exclude admin fee |
| billKey1 | String | C | additional bill data identifier, same with inquiry request |
| billKey2 | String | C | additional bill data identifier, same with inquiry request |

- HTTP Headers Response:
    

| **Name** | **Format** | **Required** | **Description** |
| --- | --- | --- | --- |
| signature | String | M | signature response, **optionally provided** if the CA wants it, otherwise it defaults to the same signature in the request. |
| timestamp | String, date formatted | M | time of AJ response time with time zone information, (ISO 8601) format |

- Response Definition:
    

| **Field** | **Data Type** | **Mandatory** | **Description** |
| --- | --- | --- | --- |
| billerId | String | M | Echo from request |
| transId | Object | M | Object used to identify transaction |
| transData | Object | M | Echo from request |
| billInfo | Array of Object | M | The minimum data is echo from request. There can be additional data in payment response. Please refers to Appendix document.  <br>If there is no information, the will be the same as request. |
| billRefInfo | Object | C | Object of bill reference information if transaction successful |
| descUI | String | C | Text data need to be displayed after inquiry.  <br>Data content of this field follow the standard JSON String type. |
| footer | String | C | Information from biller, that expected to be shown on footer receipt. Data content of this field follow the standard JSON String type. |

**transId**

| **Field** | **Data Type** | **Mandatory** | **Description** |
| --- | --- | --- | --- |
| STAN | String, 6 digit numeric | M | Echo from request |
| RRN | String, 12 digit numeric | M | Echo from request |
| termId | String, max 15 digit | M | Echo from request |
| channelId | String, max 4 digit | O | Echo from request |
| subAcqId | String, max 8 digit numeric | C | Echo from request |
| authKey | String | C | Echo from request |
| totalAmount | Numeric | M | Echo from request |
| respCode | String | M | Response code from biller/API. See list of response code for detail error information |

**billInfo**

| **Field** | **Data Type** | **Mandatory** | **Description** |
| --- | --- | --- | --- |
| field | String | M | field name of bill information |
| isArray | Boolean | M | identifier whether the value is a list of value(array) or single value. If it’s an array, character coma (,) should be used to split it |
| value | String | M | value of bill information |

**billRefInfo**

| **Field** | **Data Type** | **Mandatory** | **Description** |
| --- | --- | --- | --- |
| billRef | String | M | Reference from biller as proof of payment |
| additionalInfo1 | String | C | additional info from biller on successful payment |
| additionalInfo2 | String | C | additional info from biller on successful payment |

### Example Request
```json
{
    "billerId": "45034",
    "transId": {
        "RRN": "129999910134",
        "STAN": "000134",
        "termId": "12999991",
        "channelId": "6010",
        "subAcqId": "000001",
        "authKey" : "6A1CB5460CDFF065E22D9043FA0035B7",
        "totalAmount": 101500.00
    },
    "transData": {
        "idCustomer": "0857222222210",
        "adminFee": 1500.0,
        "billAmount" : 100000.0,
        "billKey1" : "",
        "billKey2" : ""
    },
    "billInfo":[
        {
            "field": "idCustomer",
            "ID" : 1,
            "isArray" : false,
            "value": "value1"
        },
        {
            "field": "unsoldToken",
            "ID" : 2,
            "isArray" : true,
            "arrValue": ["token1", "token2", "token3"]
        }
    ]
}
```

### Example Response
```json
{
    "billerId": "45034",
    "transId": {
        "RRN": "129999910134",
        "STAN": "000134",
        "termId": "12999991",
        "channelId": "6010",
        "subAcqId": "000001",
        "authKey" : "6A1CB5460CDFF065E22D9043FA0035B7",
        "totalAmount": 101500.00,
        "respCode": "00"
    },
    "transData": {
        "idCustomer": "0857222222210",
        "adminFee": 1500.0,
        "billAmount" : 100000.0,
        "billKey1" : "",
        "billKey2" : ""
    },
    "billInfo":[
        {
            "field": "idCustomer",
            "ID" : 1,
            "isArray" : false,
            "value": "value1"
        },
        {
            "field": "unsoldToken",
            "ID" : 2,
            "isArray" : true,
            "arrValue": ["token1", "token2", "token3"]
        }
    ],
    "billRefInfo": {
        "billRef": "asdnqoqwe1",
        "additionalInfo1": "2020-08-20",
        "additionalInfo2" : null
    },
    "descUI" :"blablabla",
    "footer" :"Thanks For Your Purchase"
}
```

## 5.4. Advice
This API is use to do advice transaction. The format of data is the same as Payment but different HTTP Method Path

- HTTP Method: **POST**
    
- Path for **Payment Billers**: /Artajasa/bersamaPayment/advice
    
- HTTP Headers:
    

| **Name** | **Format** | **Required** | **Description** |
| --- | --- | --- | --- |
| signature | String | M | Signature Request |
| timestamp | String, date formatted | M | time of transaction on with time zone information, (ISO 8601) format |
| acquirerId | String | M | acquirer id identifier given by AJ |

- Query String Parameters: None
    
- Format: application/json
    
- Authentication: None
    
- Request Definitions:
    

| **Field** | **Data Type** | **Mandatory** | **Description** |
| --- | --- | --- | --- |
| billerId | String | M | Unique biller ID |
| transId | Object | M | Object used to identify transaction |
| transData | Object | M | List of data related to biller to do transaction. should be the same with inquiry response |
| billInfo | Array of Object | M | List of biller information. Results from the inquiry response should be sent back here. |

**transId**

| **Field** | **Data Type** | **Mandatory** | **Description** |
| --- | --- | --- | --- |
| STAN | String, 6 digit numeric | M | System Trace Audit Number, Value increase by 1 from previous transaction |
| RRN | String, 12 digit numeric | M | Retrieval reference number — unique ID incremented by end-user request |
| termId | String, max 15 digit | M | Unique terminal ID per end-user / mobile number |
| channelId | String, max 4 digit | O | It is used to know the type of channel where the transaction is performed. See list of channel Id for detail channel type information |
| subAcqId | String, max 8 digit numeric | C | Sub Acquirer ID. It must exist if the Collecting Agent (acquirer) is aggregator that has ‘Sub-Acquirer’ as payment channel. |
| authkey | String | M | Unique key retrieve from inquiry response. |
| totalAmount | Numeric | M | Total Payment amount, include admin fee (billAmount + adminFee) |

**transData**

| **Field** | **Data Type** | **Mandatory** | **Description** |
| --- | --- | --- | --- |
| idCustomer | String | M | customer id from biller |
| adminFee | Numeric | M | admin fee retrieve from inquiry response. |
| billAmount | Numeric | M | bill amount retrieve from inquiry response. In case of open payment, sender should fill the payment amount from customer here, exclude admin fee. Basically this is the amount customer need to pay, exclude admin fee |
| billKey1 | String | C | additional bill data identifier, same with inquiry request |
| billKey2 | String | C | additional bill data identifier, same with inquiry request |

- HTTP Headers Response:
    

| **Name** | **Format** | **Required** | **Description** |
| --- | --- | --- | --- |
| signature | String | M | signature response, **optionally provided** if the CA wants it, otherwise it defaults to the same signature in the request. |
| timestamp | String, date formatted | M | time of AJ response time with time zone information, (ISO 8601) format |

- Response Definition:
    

| **Field** | **Data Type** | **Mandatory** | **Description** |
| --- | --- | --- | --- |
| billerId | String | M | Echo from request |
| transId | Object | M | Object used to identify transaction |
| transData | Object | M | Echo from request |
| billInfo | Array of Object | M | The minimum data is echo from request. There can be additional data in payment response. Please refers to Appendix document.  <br>If there is no information, the will be the same as request. |
| billRefInfo | Object | C | Object of bill reference information if transaction successful |
| descUI | String | C | Text data need to be displayed after inquiry.  <br>Data content of this field follow the standard JSON String type. |
| footer | String | C | Information from biller, that expected to be shown on footer receipt. Data content of this field follow the standard JSON String type. |

**transId**

| **Field** | **Data Type** | **Mandatory** | **Description** |
| --- | --- | --- | --- |
| STAN | String, 6 digit numeric | M | Echo from request |
| RRN | String, 12 digit numeric | M | Echo from request |
| termId | String, max 15 digit | M | Echo from request |
| channelId | String, max 4 digit | O | Echo from request |
| subAcqId | String, max 8 digit numeric | C | Echo from request |
| authKey | String | C | Echo from request |
| totalAmount | Numeric | M | Echo from request |
| respCode | String | M | Response code from biller/API. See list of response code for detail error information |

**billInfo**

| **Field** | **Data Type** | **Mandatory** | **Description** |
| --- | --- | --- | --- |
| field | String | M | field name of bill information |
| isArray | Boolean | M | identifier whether the value is a list of value(array) or single value. If it’s an array, character coma (,) should be used to split it |
| value | String | M | value of bill information |

**billRefInfo**

| **Field** | **Data Type** | **Mandatory** | **Description** |
| --- | --- | --- | --- |
| billRef | String | M | Reference from biller as proof of payment |
| additionalInfo1 | String | C | additional info from biller on successful payment |
| additionalInfo2 | String | C | additional info from biller on successful payment |

### Example Request
```json
{
    "billerId": "45039",
    "transId": {
        "RRN": "129999910134",
        "STAN": "000134",
        "termId": "12999991",
        "channelId": "6010",
        "subAcqId": "000001",
        "authKey" : "6A1CB5460CDFF065E22D9043FA0035B7",
        "totalAmount": 101500.00
    },
    "transData": {
        "idCustomer": "0857222222210",
        "adminFee": 1500.0,
        "billAmount" : 100000.0,
        "billKey1" : "",
        "billKey2" : ""
    },
    "billInfo":[
        {
            "field": "idCustomer",
            "ID" : 1,
            "isArray" : false,
            "value": "value1"
        },
        {
            "field": "unsoldToken",
            "ID" : 2,
            "isArray" : true,
            "arrValue": ["token1", "token2", "token3"]
        }
    ]
}
```

### Example Response
```json
{
    "billerId": "45039",
    "transId": {
        "RRN": "129999910134",
        "STAN": "000134",
        "termId": "12999991",
        "channelId": "6010",
        "subAcqId": "000001",
        "authKey" : "6A1CB5460CDFF065E22D9043FA0035B7",
        "totalAmount": 101500.00,
        "respCode": "00"
    },
    "transData": {
        "idCustomer": "0857222222210",
        "adminFee": 1500.0,
        "billAmount" : 100000.0,
        "billKey1" : "",
        "billKey2" : ""
    },
    "billInfo":[
        {
            "field": "idCustomer",
            "ID" : 1,
            "isArray" : false,
            "value": "value1"
        },
        {
            "field": "unsoldToken",
            "ID" : 2,
            "isArray" : true,
            "arrValue": ["token1", "token2", "token3"]
        }
    ],
    "billRefInfo":{
        "billRef": "asdnqoqwe1",
        "additionalInfo1": "2020-08-20",
        "additionalInfo2" : null
    },
    "descUI" :"blablabla",
    "footer" :"Thanks For Your Purchase"
}
```

## 5.5. Check Status

This API is used to check transaction status of payment request (rc)

- HTTP Method: **POST**
    
- Path for **Payment Billers**: /Artajasa/bersamaPayment/status
    
- Path for **Topup Billers**: /Artajasa/bersamaTopup/status
    
- HTTP Headers:
    

| **Name** | **Format** | **Required** | **Description** |
| --- | --- | --- | --- |
| signature | String | M | Signature Request |
| timestamp | String, date formatted | M | time of transaction on with time zone information, (ISO 8601) format |
| acquirerId | String | M | acquirer id identifier given by AJ |

- Query String Parameters: None
    
- Format: application/json
    
- Authentication: None
    
- Request Definitions:
    

| **Field** | **Data Type** | **Mandatory** | **Description** |
| --- | --- | --- | --- |
| billerId | String | M | Unique biller ID |
| transId | Object | M | Object used to identify transaction. Use the same transId on payment request. |
| transData | Object | M | List of data related to biller to do transaction. Use the same transData on paymentRequest |

- HTTP Headers Response:
    

| **Name** | **Format** | **Required** | **Description** |
| --- | --- | --- | --- |
| signature | String | M | signature response, **optionally provided** if the CA wants it, otherwise it defaults to the same signature in the request. |
| timestamp | String, date formatted | M | time of AJ response time with time zone information, (ISO 8601) format |

- Response Definition:
    

| **Field** | **Data Type** | **Mandatory** | **Description** |
| --- | --- | --- | --- |
| billerId | String | M | Echo from request |
| transId | Object | M | Object used to identify transaction |
| transData | Object | M | Echo from request |
| billInfo | Array of Object | C | Echo from request |
| billRefInfo | Object | C | Object of bill reference information if transaction successful |
| descUI | String | M | Text data need to be displayed after inquiry.  <br>  <br>Data content of this field follow the standard JSON String type. |

**transId**

| **Field** | **Data Type** | **Mandatory** | **Description** |
| --- | --- | --- | --- |
| STAN | String, 6 digit numeric | M | Echo from request |
| RRN | String, 12 digit numeric | M | Echo from request |
| termId | String, max 15 digit | M | Echo from request |
| channelId | String, max 4 digit | O | Echo from request |
| subAcqId | String, max 8 digit numeric | C | Echo from request |
| authKey | String | C | Echo from request |
| respCode | String | M | Response code from biller/API. See list of response code for detail error information |

**billInfo**

| **Field** | **Data Type** | **Mandatory** | **Description** |
| --- | --- | --- | --- |
| field | String | M | field name of bill information |
| isArray | Boolean | M | identifier whether the value is a list of value(array) or single value. If it’s an array, character coma (,) should be used to split it |
| value | String | M | value of bill information |

**billRefInfo**

| **Field** | **Data Type** | **Mandatory** | **Description** |
| --- | --- | --- | --- |
| billRef | String | M | Reference from biller as proof of payment |
| additionalInfo1 | String | O | additional info from biller on successful payment |
| additionalInfo2 | String | O | additional info from biller on successful payment |

### Example Request
```json
{
    "billerId": "45034",
    "transId": {
        "RRN": "129999910134",
        "STAN": "000134",
        "termId": "12999991",
        "channelId": "6010",
        "subAcqId": "000001",
        "authKey" : "6A1CB5460CDFF065E22D9043FA0035B7",
        "totalAmount": 101500.0
    },
    "transData": {
        "idCustomer": "0857222222210",
        "adminFee": 1500.0,
        "billAmount" : 100000.0,
        "billKey1" : "",
        "billKey2" : ""
    }
}
```

### Example Response
```json
{
    "billerId": "45034",
    "transId": {
        "RRN": "129999910133",
        "STAN": "000133",
        "termId": "12999991",
        "channelId": "6010",
        "subAcqId": "000001",
        "authKey" : "6A1CB5460CDFF065E22D9043FA0035B7",
        "totalAmount": 101500.0,
        "respCode": "00"
    },
    "transData": {
        "idCustomer": "0857222222210",
        "adminFee": 1500.0,
        "billAmount" : 100000.0,
        "billKey1" : "",
        "billKey2" : ""
    },
    "billInfo":[
        {
            "field": "idCustomer",
            "ID" : 1,
            "isArray" : false,
            "value": "value1"
        },
        {
            "field": "unsoldToken",
            "ID" : 2,
            "isArray" : true,
            "arrValue": ["token1", "token2", "token3"]
        }
    ],
    "billRefInfo":{
        "billRef": "asdnqoqwe1",
        "additionalInfo1": "2020-08-20",
        "additionalInfo2" : null
    },
    "descUI" :"blablabla"
}
```

## 5.6. Reversal
This API is used to reverse payment request.

- HTTP Method: **POST**
    
- Path: /Artajasa/bersamaPayment/Reversal
    
- HTTP Headers:
    

| **Name** | **Format** | **Required** | **Description** |
| --- | --- | --- | --- |
| signature | String | M | Signature Request |
| timestamp | String, date formatted | M | time of transaction on with time zone information, (ISO 8601) format |
| acquirerId | String | M | acquirer id identifier given by AJ |

- Query String Parameters: None
    
- Format: application/json
    
- Authentication: None
    
- Request Definition:
    

| **Field** | **Data Type** | **Mandatory** | **Description** |
| --- | --- | --- | --- |
| billerId | String | M | Unique biller ID |
| transId | Object | M | Object used to identify transaction. Use the same transId on payment request. |
| transData | Object | M | List of data related to biller to do transaction. Use the same transData on payment request |

- HTTP Headers Response:
    

| **Name** | **Format** | **Required** | **Description** |
| --- | --- | --- | --- |
| signature | String | M | signature response |
| timestamp | String, date formatted | M | time of AJ response time with time zone information, (ISO 8601) format |

- Response Definition:
    

| **Field** | **Data Type** | **Mandatory** | **Description** |
| --- | --- | --- | --- |
| billerId | String | M | Echo from request |
| transId | Object | M | Object used to identify transaction |
| transData | Object | M | Echo from request |
| billInfo | Array of Object | C | Echo from request |
| billRefInfo | Object | C | Object of bill reference information if transaction successful |
| descUI | String | M | Text data need to be displayed after inquiry.  <br>  <br>Data content of this field follow the standard JSON String type. |

**transId**

| **Field** | **Data Type** | **Mandatory** | **Description** |
| --- | --- | --- | --- |
| STAN | String, 6 digit numeric | M | Echo from request |
| RRN | String, 12 digit numeric | M | Echo from request |
| termId | String, max 15 digit | M | Echo from request |
| channelId | String, max 4 digit | O | Echo from request |
| subAcqId | String, max 8 digit numeric | C | Echo from request |
| authKey | String | M | Echo from request |
| respCode | String | M | Response code from biller/API. See list of response code for detail error information |

**billInfo**

| **Field** | **Data Type** | **Mandatory** | **Description** |
| --- | --- | --- | --- |
| field | String | M | field name of bill information |
| isArray | Boolean | M | identifier whether the value is a list of value(array) or single value. If it’s an array, character coma (,) should be used to split it |
| value | String | M | value of bill information |

**billRefInfo**

| **Field** | **Data Type** | **Mandatory** | **Description** |
| --- | --- | --- | --- |
| billRef | String | M | Reference from biller as proof of payment |
| additionalInfo1 | String | O | additional info from biller on successful payment |
| additionalInfo2 | String | O | additional info from biller on successful payment |


### Example Request
```json
{
    "billerId": "45034",
    "transId": {
        "RRN": "129999910133",
        "STAN": "000133",
        "termId": "12999991",
        "channelId": "6010",
        "subAcqId": "000001",
        "authKey" : "6A1CB5460CDFF065E22D9043FA0035B7",
        "totalAmount": 101500.00
    },
    "transData": {
        "idCustomer": "0857222222210",
        "adminFee": 1500.0,
        "billAmount" : 100000.0,
        "billKey1" : "",
        "billKey2" : ""
    }
}
```

### Example Response
```json
{
    "billerId": "45034",
    "transId": {
        "RRN": "129999910133",
        "STAN": "000133",
        "termId": "12999991",
        "channelId": "6010",
        "subAcqId": "000001",
        "authKey" : "6A1CB5460CDFF065E22D9043FA0035B7",
        "totalAmount": 101500.00,
        "respCode": "00"
    },
    "transData": {
        "idCustomer": "0857222222210",
        "adminFee": 1500.0,
        "billAmount" : 100000.0,
        "billKey1" : "",
        "billKey2" : ""
    },
    "billInfo":[
        {
            "field": "idCustomer",
            "ID" : 1,
            "isArray" : false,
            "value": "value1"
        },
        {
            "field": "unsoldToken",
            "ID" : 2,
            "isArray" : true,
            "arrValue": ["token1", "token2", "token3"]
        }
    ],
    "billRefInfo":{
        "billRef": "asdnqoqwe1",
        "additionalInfo1": "2020-08-20",
        "additionalInfo2" : null
    },
    "descUI" :"blablabla"
}
```

# 5.7 Update Balance
This API is used specifically for **Topup** billers that require some form of data to be passed from/to a **card** itself, usually to **update the balance** of that card after a **Topup** process for that card has been concluded.

- HTTP Method: **POST**
    
- Path: /Artajasa/bersamaTopup/updateBalance
    
- HTTP Headers:
    

| **Name** | **Format** | **Required** | **Description** |
| --- | --- | --- | --- |
| signature | String | M | Signature Request |
| timestamp | String, date formatted | M | time of transaction on with time zone information, (ISO 8601) format |
| acquirerId | String | M | acquirer id identifier given by AJ |

- Query String Parameters: None
    
- Format: application/json
    
- Authentication: None
    
- Request Definition:
    

| **Field** | **Data Type** | **Mandatory** | **Description** |
| --- | --- | --- | --- |
| billerId | String | M | Unique biller ID |
| transId | Object | M | Object used to identify transaction.  <br>  <br>Should have the same values as with the Payment request, albeit with the amount fields set to 0. |
| transData | Object | M | List of data related to biller to do transaction.  <br>  <br>Should have the same values as with the Payment request, albeit with the amount fields set to 0. |
| cardData | Object | C | Object used for card based transaction only, its presence and the fields it has depends on the biller. |
| billInfo | Object | M | List of biller information. The result from this transaction flow’s Payment response should be resent here. |
| billRefInfo | Object | C | Object of bill reference information if the transaction is successful.  <br>  <br>The result from this transaction flow’s successful Payment response should be resent here. |

**transId**

| **Field** | **Data Type** | **Mandatory** | **Description** |
| --- | --- | --- | --- |
| STAN | String, 6 digit numeric | M | System Trace Audit Number, Value increase by 1 from previous transaction |
| RRN | String, 12 digit numeric | M | Retrieval reference number — unique ID incremented by end-user request |
| termId | String, max 15 digit | M | Unique terminal ID per end-user / mobile number |
| channelId | String, max 4 digit | O | It is used to know the type of channel where the transaction is performed. See list of channel Id for detail channel type information |
| subAcqId | String, max 8 digit numeric | C | Sub Acquirer ID. It must exist if the Collecting Agent (acquirer) is aggregator that has ‘Sub-Acquirer’ as payment channel. |
| authKey | String | M | Unique key retrieve from same as in Payment Request. |
| totalAmount | Numeric | M | Fill with 0. |

**transData**

| **Field** | **Data Type** | **Mandatory** | **Description** |
| --- | --- | --- | --- |
| idCustomer | String | M | customer id from biller |
| adminFee | Numeric | O | Depends on the biller, but it’s usually unncessary and can be filled with 0. |
| billAmount | Numeric | O | Depends on the biller, but it’s usually unncessary and can be filled with 0. |
| billKey1 | String | C | additional bill data identifier |
| billKey2 | String | C | additional bill data identifier |

**cardData**

| **Field** | **Data Type** | **Mandatory** | **Description** |
| --- | --- | --- | --- |
| encryptedCard | Sting | M | Encoded card data written in string value, often used directly in the function variables that needs it. |
| authData | String | C | Access card data/cryptographic data for card-based transactions. |
| topupCode | String | C | Code used for some biller’s topup process. |
| cardStatus | String | C | Information on the result of the card topup process on the client’s side. |

- HTTP Headers Response:
    

| **Name** | **Format** | **Required** | **Description** |
| --- | --- | --- | --- |
| signature | String | M | signature response |
| timestamp | String, date formatted | M | time of AJ response time with time zone information, (ISO 8601) format |

- Response Definition:
    

| **Field** | **Data Type** | **Mandatory** | **Description** |
| --- | --- | --- | --- |
| billerId | String | M | Echo from request |
| transId | Object | M | Object used to identify transaction |
| transData | Object | M | List of data related to biller to do transaction |
| billInfo | Array of Object | C | List of bill information from biller. Will be given if transaction is successful |
| cardData | Object | C | Object used for card based transaction only |

**transId**

| **Field** | **Data Type** | **Mandatory** | **Description** |
| --- | --- | --- | --- |
| STAN | String, 6 digit numeric | M | Echo from request |
| RRN | String, 12 digit numeric | M | Echo from request |
| termId | String, max 15 digit | M | Echo from request |
| channelId | String, max 4 digit | O | Echo from request |
| subAcqId | String, max 8 digit numeric | C | Echo from request |
| respCode | String | M | Response code from biller/API. See list of response code for detail error information |

**transData**

| **Field** | **Data Type** | **Mandatory** | **Description** |
| --- | --- | --- | --- |
| idCustomer | String | M | Echo from request |
| adminFee | Numeric | O | Echo from request |
| billAmount | Numeric | O | In most cases it’s echoed from the request, but in some billers it will be filled with the amount sent in the Payment request. |
| billKey1 | String | O | Echo from request |
| billKey2 | String | O | Echo from request |

**cardData**

| **Field** | **Data Type** | **Mandatory** | **Description** |
| --- | --- | --- | --- |
| encryptedCard | Sting | M | Echo from request |
| authData | String | C | Access token / Cryptographic data for card based transaction |
| topupCode | String | C | Echo from request |
| cardStatus | String | C | Echo from request |

### Example Request
```json
{
    "billerId": "93600911",
    "transId": {
        "RRN": "129999910134",
        "STAN": "000134",
        "termId": "12999991",
        "channelId": "6010",
        "subAcqId": "000001",
        "authKey": "6A1CB5460CDFF065E22D9043FA0035B7",
        "totalAmount": 101500.0
    },
    "transData": {
        "idCustomer": "0857222222210",
        "adminFee": 1500.0,
        "billAmount": 100000.0,
        "billKey1": "",
        "billKey2": "",
        "originatorCustomerNo": "0857222222210",
        "originatorCustomerName": "Nama Customer Test"
    },
    "billInfo": [
        {
            "field": "Biller Transaction ID",
            "ID": 1,
            "isArray": false,
            "value": "946500130314326"
        }
    ],
    "billRefInfo": {
        "billRef": "946500130314326",
        "additionalInfo1": null,
        "additionalInfo2": null
    },
    "cardData": {
        "encodedData": "00907546130000530171754613000053017147F74D2D0BE3639994371FBA2F14B80C000000000101704F000000000600138836C54E01000000000600138836C54E01000000000000000000005227E3ECE1E46EEA0C1254D14FDEBB37",
        "authData": "0600238236C55A520000000000000000AC1DFA0E77F0C05402192355A70CDE9B",
        "accessCode": "138414",
        "cardStatus": "01"
    }
}
```

### Example Response
```json
{
    "billerId": "93600911",
    "transId": {
        "RRN": "129999910134",
        "STAN": "000134",
        "termId": "12999991",
        "channelId": "6010",
        "subAcqId": "000001",
        "authKey": "6A1CB5460CDFF065E22D9043FA0035B7",
        "totalAmount": 101500.0,
        "respCode": "00"
    },
    "transData": {
        "idCustomer": "0857222222210",
        "adminFee": 1500.0,
        "billAmount": 100000.0,
        "billKey1": "",
        "billKey2": "",
        "originatorCustomerNo": "0857222222210",
        "originatorCustomerName": "Nama Customer Test"
    },
    "billInfo": [
        {
            "field": "Biller Transaction ID",
            "ID": 1,
            "isArray": false,
            "value": "946500130314326"
        }
    ],
    "billRefInfo": {
        "billRef": "946500130314326",
        "additionalInfo1": null,
        "additionalInfo2": null
    },
    "cardData": {
        "encodedData": "00907546130000530171754613000053017147F74D2D0BE3639994371FBA2F14B80C000000000101704F000000000600138836C54E01000000000600138836C54E01000000000000000000005227E3ECE1E46EEA0C1254D14FDEBB37",
        "authData": "0600238236C55A520000000000000000AC1DFA0E77F0C05402192355A70CDE9B",
        "accessCode": "138414",
        "cardStatus": "01"
    }
}
```

# 6\. Channel Id

The valid value for tag transId.channelId are as follow:

| **Channel Id** | **Description** |
| --- | --- |
| 6010 | Teller |
| 6011 | ATM |
| 6012 | EDC |
| 6013 | Phone Banking |
| 6014 | Internet Banking |
| 6015 | KIOSK |
| 6016 | Auto Debit |
| 6017 | Mobile Banking/SMS Banking |


# 7\. Response Code
| **Code** | **Description** |
| --- | --- |
| 00 | Successful |
| 03 | Invalid merchant |
| 05 | Undefined error/Do not Honor |
| 12 | Invalid Transaction/Reversal denied/BP host cannot reversal |
| 13 | Invalid transaction amt(not same as total bill) |
| 14 | Customer ID/Card number is not found |
| 15 | No such issuer/merchant |
| 20 | Invalid Response |
| 27 | Payment ID status cannot be processed |
| 30 | Format error |
| 31 | Bank not supported by switch |
| 40 | Bank not supported by BP |
| 41 | Transaction amount is below minimum value |
| 51 | Insufficient Balance |
| 57 | Account Type not supported |
| 58 | Delivery channel not supported |
| 59 | Suspected Fraud |
| 61 | Maximum topup amount reach |
| 63 | Security violation |
| 65 | Maximum topup frequency reach |
| 68 | Inq/Trf/Pay/rvsl denied by late response |
| 69 | Pay denied by database timeout |
| 70 | Pay denied by voucher not exists |
| 76 | Different customer name in one bills |
| 77 | There are more than 3 unpaid bills/no related account |
| 79 | Phone number blocked |
| 80 | At least 1 bill reference is not found |
| 81 | Phone number expired |
| 83 | Too close to previous transactions |
| 88 | Payment denied, bill already paid |
| 89 | Link to bill provider is down |
| 91 | Database problem |
| 92 | Unable to route transaction |
| 94 | Duplicate reversal request |
| 96 | System Malfunction/system error |


# 8\. Signature

For security purposes, an encrypted signature on the request is **mandatory**, while the same method on the **response** can be provided **as an option** should the Collecting Agent (CA) wants it. The encryption method acceptable by the system at the moment is as follows:

- HMAC-SHA256 (**default**)
    
- SHA256 with RSA
    

Only one of the methods given above are applicable at any given moment for a Collecting Agent’s entire API features (Inquiry, Payment, etc.), and that method will apply in both the request and the response (if the CA requires it).


## 8.1. HMAC-SHA256

For this method, the formula to generate the string that needs to be signed to construct the signature is **payload:timestamp**. AJ will create a secretkey string for CA, which will be used to sign the previous string on signature request. This is **mandatory**.

That very same key will then be used to construct the signature on the response, **if** the CA **opts for it**. Therefore a signature response **can be provided. If AJ is not required to provide a signature on the response**, then the system will instead send back the signature sent on the request.

The example for this method can be seen below:

- Secretkey : Art4ja54
    
- Payload : Contains the request body sent.  
    o Note that any unneeded whitespaces, tabs, and/or newlines needs to be **removed** from the payload to construct this signature, with one way of doing it is through **minify**(RequestBody)
    

```
{"billerId":"45034","transId":{"RRN":"129999910133","STAN":"000133","termId":"12999991","channelId":"6010"},"transData":{"idCustomer":"0857222222210","adminFee":0,"billAmount":0,"billKey1":"","billKey2":""}}

 ```

- Timestamp : 2020-08-17T19:45:21+07:00
    
- minify(RequestBody):timestamp (string_to_sign): {"billerId":"45034","transId":{"RRN":"129999910133","STAN":"000133""termId":"12999991","channelId":"6010"},"transData":{"idCustomer":"0857222222210","adminFee":0,"billAmount":0,"billKey1":"","billKey2":""}}:2020-08-17T19:45:21+07:00
    
- Hex Encoded Signature HMAC-SHA 256: 7f2444e6dce051e70e960cfa46e4f649bab6846423a1bed4e381c7a64f5eade1

## 8.2. SHA256 with RSA

For this method, the formula to generate the string that needs to be signed to construct the signature is **payload:timestamp**. For the request, the CA needs to generate a pair of public and private key, and then provide to AJ the public key so that this system can verify the signature generated. This is **mandatory**.

For the response, if the CA opts for it then AJ will generate a pair of public and private key. AJ will then send the public key to the CA using a method that is acceptable for the CA. When AJ sends a signature on the response, the CA can then verify it using the public key sent beforehand.  
**If AJ is not required to provide a signature on the response**, then the system will instead send back the signature sent on the request.

Below are the steps to construct the signature:

**Private - Public Key:**

- **Public Key:**  
    Please provide the public key in a X.509 (.pem) file format. An example of the file content is:
    

```
-----BEGIN PUBLIC KEY-----
MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAqQEHfEV/C0+rNWuCdneY
9Ctak5JWDlX+HpRN9Oj/rdf57rkwBqAY1kKI5M9f3IYS+kpJgrZe8L+r71FW1p+V
25ZgxsbCRtW9U5uLUEMDQM9VbAYTUAhioyCZafLjQHKdMteEd2S5gBveEbLQWb0r
AEwEpnqbWOc+dNuDHgoJAOaCCnflYEx02TCQorIfZBo+QOIw90h2X33hwpmHtTUI
3lCqwPrj45qW2gJtR54rwEwpLS3lkqN2KrC+GaxYXaLd3Pv9s+Rl3tufI5aFYd+o
33Jzs2Damg58sIPeqqKKtjtybl6t2rqlO1kKHzV9bO6VyJUnAfkiqwW9tR2bFHXo
gwIDAQAB
-----END PUBLIC KEY-----

 ```

- **Private Key:**
    

As a sample, a matching private key to the public key above would be like so:

```
-----BEGIN PRIVATE KEY-----
MIIEvgIBADANBgkqhkiG9w0BAQEFAASCBKgwggSkAgEAAoIBAQCpAQd8RX8LT6s1
a4J2d5j0K1qTklYOVf4elE306P+t1/nuuTAGoBjWQojkz1/chhL6SkmCtl7wv6vv
UVbWn5XblmDGxsJG1b1Tm4tQQwNAz1VsBhNQCGKjIJlp8uNAcp0y14R3ZLmAG94R
stBZvSsATASmeptY5z5024MeCgkA5oIKd+VgTHTZMJCish9kGj5A4jD3SHZffeHC
mYe1NQjeUKrA+uPjmpbaAm1HnivATCktLeWSo3YqsL4ZrFhdot3c+/2z5GXe258j
loVh36jfcnOzYNqaDnywg96qooq2O3JuXq3auqU7WQofNX1s7pXIlScB+SKrBb21
HZsUdeiDAgMBAAECggEAAvvOqwX7ETMN3bqRKhBAdgcR6UsLE+O2wclyeuFmKiaG
9gz06RkIdzfjfM6gbZ88VIjdNV6M3Ik1utrfwpg8qAzGlpvJsEBzwDcdxYP5WbqP
UoHk82PCggjATJuKIYgkeFJPt1/i2n0jdYKHpR3u1WmCJ4JAndgvRRbfALfCou5n
geebj0/P64q4ZA7K42WjUX2vTVcWZNM2/2H/HhSWPU+BVPeeiXjPO/PSp8Z74Xd4
EkvaI+9Blrp8aKwWeLx3snjyd3rEhx0uXdlbpR9eApvrmAnVrmzb4DbOgp/zvhJy
vRe0EfTOU8GlEMX2NsE4DYPSx0zBti8GGH3Z4BWUkQKBgQDXyBTKJ1N66YGN5I0K
a5uRu26Lu2LASKAWjoJksjTVn3ezTgibuEbwkL8/qBHlnjXwNWw8goQs5yHjJUw+
7bhhqWbPrUjwVA847ujQm0WaCN2BEKMZxNINdYKVT7+ttQDEbwjZ7+3pZJ9SlxnZ
qcZtYA2DodgnN0WP7XjVEJXjCQKBgQDIgPqRZOve3S1duwGxI77nII4+HtNnyC8J
Pu76SFI3sYSGDvJkP9PTQUjL6hUXA+r1F6KWTYuWtX3JqUH51e5fOr3nypfq1lAq
PLR0uYts4TfAaxwSpHBdSsjs/kvhpV0EZCIEOkKahmnheprePPn06cYwvA4sJJj0
I0ICbxYWKwKBgGmKpJiICa3pvoNfkZjSL0JlkdloqxFvtFW0GJUWEP+Xwx2BgnZf
+Nq7gb+p/i74Zlt6Vdl24R1xY8LNQHDbJz8lc3MKx8084EExodA+0hlYUrdJIu18
tlz86AUN/6wAB0MNKCAo2Y45uC/WVj9/ad2fiJyksavkvfJ67YoRVa65AoGBAKsk
jLx2LG8603JiIXuWS2j1fPTBUyoO0TdPJKU1/hfTyo6zS2sOoDx+SSjlUcMncPJr
jjhFUJT/rbLoaoxacvGOLnMflrS44gxrbI0Fo2D4jKINyxSOj+rR3teL6DFe+Rq6
bd617AwCF3aDNJXl7mWC9cy7eE1tn7EkNz/kmjGpAoGBAJDa/6r26ntgFyBvX0VS
gkKMeQsTKYcBdJFN1nWKxW8ASqpD9+BJpX8e1PhDHCfVlt9TBSuW5ieGp2Ydtzew
Yg9LQ8weVw9KrELApkyrWfK4ZP7VDgZKemyX+t1HhV2INAJ2cmqxELZCSAHXNuze
JCpT5TzjAHH5TDnird2WZyFi
-----END PRIVATE KEY-----

 ```

- Generating Key Pairs
    

There are many ways to generate an RSA key pair, but the example below will list how to generate a 2048-bit RSA key pair using the OpenSSL library:

```
openssl genpkey -algorithm RSA -out private_key.pem -pkeyopt
rsa_keygen_bits:2048
openssl rsa -in private_key.pem -pubout -out public_key.pem

 ```

This will result in a **private key** file named ”private_key.pem” and a **public key** file named ”public_key.pem” to be generated in your current directory.

**Signature Construction:**

1\. payload : Contains the request body sent.  
\- Note that any **unneeded** whitespaces, tabs, and/or newlines needs to be **removed** from the payload to construct this signature, with one way of doing it is through **minify**(RequestBody)

```
{"billerId":"45034","transId":{"RRN":"129999910133","STAN":"000133","termId":"12999991","channelId":"6010"},"transData":{"idCustomer":"0857222222210","adminFee":0,"billAmount":0,"billKey1":"Sample Data","billKey2":""}}

 ```

2\. Timestamp : 2020-08-17T19:45:21+07:00

3\. string_to_sign: payload:timestamp

```
{"billerId":"45034","transId":{"RRN":"129999910133","STAN":"000133""termId":"12999991","channelId":"6010"},"transData":{"idCustomer":"0857222222210","adminFee":0,"billAmount":0,"billKey1":"Sample Data","billKey2":""}}:2020-08-17T19:45:21+07:00

 ```

4\. Sign the ”string_to_sign” above with the Private Key that matches the Public Key sent to AJ using the **SHA-256**.  
5\. Convert the binary result into single-line Base64 for use in the **Authentication** HTTP Header.

- An example of a Base64 encoded signature that can be validated by the public key example above is:
    

```
Uic9cu1tBPkxTi6IJ6K9IbovdOURk2otn8tunP+/5ZELzALNjeC6TTssZnnCfzxZNMcjwP0nyP3H9iNHHRjIMgeH4JwpHKRpw2/+FgFm1LFioipRPFM9YkSN7Q39T9ILX24y7JjifWN898UicCcq7QQ5D590SA+tqoor2oSp9ocmLNFCB2RFstNUg6KtUO9D7UFWllT8WL52PIpTArj11O03DJBrNU+IT1DQ+5QmXMUZ6/m6NBmhDxSz/zJFWxvbfsrxMOsOq8j7QG3Szo9nj1RTtOfj6IbY0zMbM+5rfR3KOYjdK4Sw3kZ5cZ7RZWX/p8b+mLLf6nGw9uxwnOWQdA==

 ```

- Please note that decoding the base64 above into binary may need to take into account that this is Base64 without line breaks.


# 9\. Receipt Format
<img src="./images/receipt-format.png" alt="Receipt Format">

**Field-Field Mandatory:**

1. Institution Name CA/BANK
    
2. Transaction Datetime
    
3. Terminal Number/ID
    
4. Terminal Location
    
5. Receipt Number
    
6. Body Content: described for each feature in Biller Implementation
    
7. The statement to show that this receipt can be used as a valid proof of payment
